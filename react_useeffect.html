<!DOCTYPE html>
<html lang="en">
  <head>
    <title>React useEffect</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="./img/keyboard-5-16.ico" />
    <link rel="stylesheet" href="./style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,400;0,700;1,400;1,700&family=Fira+Mono:wght@400;500;700&family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!--Clickable Page Title-->
    <header>
      <a href="./index.html"><h1>React useEffect</h1></a>
      <nav id="navMenu"></nav>
    </header>

    <main class="js_notes">
      <article id="useEffect">
        <h2>useEffect</h2>
        
        <pre class="formula">useEffect(() => {<span class="variable">codes</span>}, [<span class="variable">dependencies</span>])</pre>

        <p>How useEffect works</p>
        <ul>
            <li>It runs the codes when dependencies change.</li>
        </ul>
        <p>
          When something is changed and that triggers something else to happen
          in respond of that, it's called side effect. Something that happen in
          respond of something.
        </p>
        <p>
            In class component, side effect is made using be life cycle hook for mounting, unomunting, and updating. We don't have that in function
            component. In function component we are using a
            <code>hook</code> called <code>useEffect</code>. It is often used
            together with <code>useState</code>.
          </p>
        <p>
          For example, we can display on the screen our window width. And as
          repond to width changes, for example by dragging the sides, we want
          the value to be updated as we go. In here, we can use useState to
          initially display the width value in the screen.
          <code>useEffect</code> then is used detect the change happen in window
          width utilizing event listener. Upon the change, a trigger function
          will be called. The function is then calling the set state function to
          update the state value.
        </p>
        <p>
          Another example, we can display certain type of resource on the
          screen. Say, posts, users, and comments. User can choose one of the 3
          to be displayed. Again, we will use useState to have the state. Option
          buttons are used to change this resource choice. The buttons
          essentially trigger the set state function to set a new state.
          useEffect is then used to detect the change in the state. When
          detected, it triggers fetching items depend on the type. Then the
          items can be displayed back in the screen using another state.
        </p>
        
        <p>Learn more: mount and unmount</p>

        <pre class="formula-thin">
import { useState, useEffect } from "react";</pre
        >

        <a href="#top"><hr /></a>
      </article>

      <article id="return-cleanup">
        <h2>Return clean up</h2>
        <p>
          <code>return</code> in the end of a useEffect function can be used to
          clean up things that are madein previous useEffect render. Write this
          <code>return</code> in the end of the function, but it will be
          rendered first before the rest of the code run.Example use is in
          function containing <code>addEventListener</code>. We locate the
          matching <code>removeEventListener</code> in the return. In the next
          render, the previous event listener will be removed first before the
          next one is added. This way we close the unused event listeners
          instead of having so many of them unused anymore but still around.
        </p>

        <a href="#top"><hr /></a>
      </article>

      <article id="example-window-width">
        <h2>Example 1: Display window width dynamically</h2>
        <p>
          Initial state is the indow width when the page is opened. And during
          the page use, any change to window width will automatically triggered
          the displayed value to change.
        </p>
        <p>
          Open
          <a href="https://dinarosita.github.io/react-hooks" target="_blank"
            >example</a
          >.
        </p>

        <p>Code</p>
        <ul>
          <li><code>useState</code> is used to set window width.</li>
          <li>
            A trigger function <code>handleResize</code>is used to call the
            <code>useState</code> set function.
          </li>
          <li>
            <code>useEffect</code> is used to trigger the call to the function
            through <code>addEventListener</code>.
          </li>
          <li>
            That event listener will be removed prior to the subsequent event
            listener by coding removal in the <code>return</code>.
          </li>
        </ul>

        <pre class="formula-thin">
const [windowWidth, setWindowWidth] = useState(window.innerWidth)

const handleResize = () => {
    setWindowWidth(window.innerWidth)
}

useEffect(() => {
    window.addEventListener("resize", handleResize)

    return () => {
        window.removeEventListener("resize", handleResize)
    }
}, [])    
</pre
        >

        <a href="#top"><hr /></a>
      </article>

      <article id="example-fetch-section">
        <h2>Example 2: Switch between resource type display</h2>
        <p>
          User can choose from 3 section option: posts (default), users, and
          comments. The data from chosen state will be fetched and displayed.
        </p>
        <p>
          Open
          <a href="https://dinarosita.github.io/react-hooks" target="_blank"
            >example</a
          >.
        </p>

        <p>Code</p>
        <ul>
          <li>
            2 <code>useState</code> are used.
            <ul>
              <li><code>resourceType</code> is to set the section.</li>
              <li><code>items</code> is to set the displayed data.</li>
            </ul>
          </li>
          <li>
            <code>useEffect</code> is used to detect the change in
            <code>resourceType</code> and act as coded: fetching correspond
            "items" and set it through <code>setItems</code>.
            <ul>
              <li>No <code>return</code> needed.</li>
            </ul>
          </li>
        </ul>

        <pre class="formula-thin">
const [resourceType, setResourceType] = useState("posts");
const [items, setItems] = useState([]);

useEffect(() => {
    fetch(`https://jsonplaceholder.typicode.com/${resourceType}`)
    .then((response) => response.json())
    .then((json) => setItems(json));

    return () => {
        console.log("No clean up")
    }
}, [resourceType]);   
</pre
        >

        <a href="#top"><hr /></a>
      </article>

      <article id="resources">
        <h2>Resources</h2>
        <ul>
          <li>
            <a
              href="https://www.youtube.com/watch?v=0ZJgIjIuY7U"
              target="_blank"
              >Web Dev: Learn useEffect In 13 Minutes</a
            >
          </li>
          <li>
            <a href="https://dinarosita.github.io/react-hooks" target="_blank"
              >Example page</a
            >
          </li>
        </ul>
      </article>
    </main>
    <footer>
      <a href="#top" class="nav-button-rev" style="margin: auto">Top</a>
      <a href="./index.html" class="nav-button-rev" style="margin: auto"
        >Home</a
      >
    </footer>
    <script src="./navArticle.js"></script>
  </body>
</html>
